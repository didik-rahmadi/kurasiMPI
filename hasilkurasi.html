<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Hasil Kurasi</title>
<link rel="stylesheet" href="styles.css">
</head>

<body>

<header>
  <h2>Hasil Kurasi</h2>
  <div class="controls">
    <select id="creator"></select>
    <button class="btn-primary" onclick="loadHasil()">Lihat</button>
    <button class="btn-secondary" onclick="location.href='index.html'">
      Kembali
    </button>
  </div>
</header>

<div id="contentList" class="card"></div>
<div id="detail" class="card"></div>

<script>
const API="https://script.google.com/macros/s/AKfycbx0U94YJUKABMde2BA9PDhcA5IrZ8Dh9RluFlh4pc4yMJb6rROH3fkMTZlqRpsGtPzqmg/exec";
const esc=s=>String(s||'');

async function loadCreators(){
  const r=await fetch(API+'?action=creators');
  const d=await r.json();
  creator.innerHTML='<option></option>';
  d.forEach(v=>creator.innerHTML+=`<option>${v}</option>`);
}

async function loadHasil(){
  const c=creator.value;
  if(!c) return;
  const r=await fetch(API+'?action=contents&creator='+encodeURIComponent(c));
  const d=await r.json();
  contentList.innerHTML=d.map(it=>`
    <div class="content-item" onclick="detailHasil(${it.rowNumber})">
      <b>${esc(it.identitas.E)}</b>
    </div>`).join('');
}

async function detailHasil(row){
  const r=await fetch(API+'?action=detail&row='+row);
  const d=await r.json();
  detail.innerHTML=d.qa.map(q=>`
    <b>${q.pertanyaan}</b>
    <div>${q.jawaban.join('<br>')}</div>
  `).join('');
}

loadCreators();
</script>
</body>
</html>
